const a0_0x3ccd60=a0_0xc9bf;(function(_0x243fb6,_0x2a5df1){const _0x275b19=a0_0xc9bf,_0x2b8a29=_0x243fb6();while(!![]){try{const _0x5b899a=-parseInt(_0x275b19(0x172))/0x1*(-parseInt(_0x275b19(0x165))/0x2)+parseInt(_0x275b19(0x152))/0x3+parseInt(_0x275b19(0x130))/0x4+parseInt(_0x275b19(0x162))/0x5*(parseInt(_0x275b19(0x150))/0x6)+-parseInt(_0x275b19(0x138))/0x7*(parseInt(_0x275b19(0x161))/0x8)+-parseInt(_0x275b19(0x16d))/0x9*(parseInt(_0x275b19(0x160))/0xa)+parseInt(_0x275b19(0x147))/0xb*(parseInt(_0x275b19(0x111))/0xc);if(_0x5b899a===_0x2a5df1)break;else _0x2b8a29['push'](_0x2b8a29['shift']());}catch(_0x3b362c){_0x2b8a29['push'](_0x2b8a29['shift']());}}}(a0_0x1166,0xb3a6d));function a0_0xc9bf(_0x315f5c,_0x52d92c){_0x315f5c=_0x315f5c-0x109;const _0x116625=a0_0x1166();let _0xc9bf8d=_0x116625[_0x315f5c];return _0xc9bf8d;}import{dom}from'./dom.js';import{state,updateState}from'./state.js';import{animateScreenSwitch,animateOpenModal}from'./ui.js';import{STRINGS}from'./localization.js';const API_ROOT=a0_0x3ccd60(0x148);export function isAuthorized(){const _0x3bef5e=a0_0x3ccd60,_0x202f86=JSON[_0x3bef5e(0x177)](localStorage[_0x3bef5e(0x13e)](_0x3bef5e(0x110)));return _0x202f86&&_0x202f86[_0x3bef5e(0x13c)]&&_0x202f86[_0x3bef5e(0x139)];}export function isPWAMode(){const _0x7877aa=a0_0x3ccd60;return window[_0x7877aa(0x176)]('(display-mode:\x20standalone)')[_0x7877aa(0x16a)]||window[_0x7877aa(0x140)][_0x7877aa(0x156)]||document[_0x7877aa(0x16f)][_0x7877aa(0x12b)](_0x7877aa(0x136));}export function showPlatformWarning(){const _0x19c6be=a0_0x3ccd60,_0x544d11=dom[_0x19c6be(0x166)][_0x19c6be(0x109)];if(dom[_0x19c6be(0x14d)])dom['passkeyDisplay'][_0x19c6be(0x109)]=_0x544d11;isPWAMode()?dom['warningContent'][_0x19c6be(0x167)]('p')[_0x19c6be(0x14b)]='<strong>üì±\x20PWA\x20(App\x20Mode)</strong><br><br>Once\x20you\x20log\x20in,\x20this\x20passkey\x20will\x20be\x20locked\x20to\x20the\x20<strong>PWA\x20only</strong>.':dom[_0x19c6be(0x146)][_0x19c6be(0x167)]('p')['innerHTML']=_0x19c6be(0x12a),dom[_0x19c6be(0x129)][_0x19c6be(0x168)][_0x19c6be(0x158)](_0x19c6be(0x143)),dom[_0x19c6be(0x154)][_0x19c6be(0x121)]=!![],dom[_0x19c6be(0x154)][_0x19c6be(0x168)][_0x19c6be(0x178)](_0x19c6be(0x10d),'cursor-not-allowed'),dom['copyPasskeyBtn']&&(dom[_0x19c6be(0x10e)][_0x19c6be(0x171)]=async()=>{const _0x386830=_0x19c6be;try{await navigator[_0x386830(0x10b)][_0x386830(0x155)](_0x544d11),dom[_0x386830(0x12e)]&&(dom[_0x386830(0x12e)][_0x386830(0x168)][_0x386830(0x158)](_0x386830(0x143)),dom[_0x386830(0x10e)][_0x386830(0x14b)]=_0x386830(0x115),setTimeout(()=>{const _0x353487=_0x386830;dom[_0x353487(0x12e)][_0x353487(0x168)][_0x353487(0x178)](_0x353487(0x143)),dom[_0x353487(0x10e)][_0x353487(0x14b)]=_0x353487(0x151);},0x7d0));}catch(_0x23121a){dom[_0x386830(0x14d)][_0x386830(0x113)](),document[_0x386830(0x149)](_0x386830(0x174));}}),dom[_0x19c6be(0x16e)][_0x19c6be(0x171)]=async()=>{const _0x11d1fe=_0x19c6be;dom[_0x11d1fe(0x129)][_0x11d1fe(0x168)]['add'](_0x11d1fe(0x143)),await proceedWithLogin();},dom[_0x19c6be(0x15c)]['onclick']=()=>{const _0x178685=_0x19c6be;dom['platformWarningModal'][_0x178685(0x168)][_0x178685(0x178)]('hidden'),dom[_0x178685(0x166)][_0x178685(0x109)]='',dom[_0x178685(0x154)][_0x178685(0x121)]=![],dom[_0x178685(0x154)][_0x178685(0x168)][_0x178685(0x158)](_0x178685(0x10d),'cursor-not-allowed');},dom[_0x19c6be(0x122)]&&(dom[_0x19c6be(0x122)][_0x19c6be(0x171)]=()=>dom[_0x19c6be(0x127)]['classList'][_0x19c6be(0x158)](_0x19c6be(0x143)));}function a0_0x1166(){const _0x42cd38=['copySuccess','style','476164EvzEwj','Login','code','textContent','reload','deviceId','android-app://','adminGenSuccess','517601XYinzg','token','verifyUnlock','removeItem','valid','Verification\x20Error:','getItem','auth','navigator','application/json','passkeyDate','hidden','errorMsg','adminSwitchToMapBtn','warningContent','11qnyjrx','/api','execCommand','adminErrorMsg','innerHTML','Invalid\x20admin\x20password','passkeyDisplay','POST','closeStaffScreen','2046Ywbycq','<span>üìã</span><span>Copy</span>','810963ElQeXn','landingPage','unlockBtn','writeText','standalone','?code=','remove','opacity','json','adminLoginBtn','cancelLoginBtn','role','Network\x20error.\x20Please\x20try\x20again.','adminLogoutBtn','11137890PzuITT','104XcTyyK','6905MXrZoJ','Verifying...','adminLoginForm','2859014smpJFM','passcodeInput','querySelector','classList','gatekeeper','matches','_blank','origin','9LkXxCX','continueLoginBtn','referrer','adminStatusMsg','onclick','1FWtZcL','/check-passkey','copy','passkeyResult','matchMedia','parse','add','value','btnAdminToggle','clipboard','adminShareBtn','opacity-50','copyPasskeyBtn','mailto:?subject=','jejak_session','6253332uFvvXJ','/get-admin-code','select','pathname','<span>‚úì</span><span>Copied!</span>','progressContainer','Admin\x20Login\x20Error:','success','networkError','setItem','trim','error','stringify','replace','user','adminResult','disabled','whatIsPWABtn','Generating...','adminGenerateBtn','staffScreen','&body=','pwaExplanationModal','invalidPasskey','platformWarningModal','<strong>üåê\x20Browser\x20Mode</strong><br><br>Once\x20you\x20log\x20in,\x20this\x20passkey\x20will\x20be\x20locked\x20to\x20the\x20<strong>browser\x20only</strong>.\x20We\x20recommend\x20installing\x20the\x20PWA\x20first!','includes','location','verifying'];a0_0x1166=function(){return _0x42cd38;};return a0_0x1166();}export async function handleAdminLogin(){const _0x4dcd3b=a0_0x3ccd60,_0x5422cd=dom['adminPasswordInput']['value'][_0x4dcd3b(0x11b)]();if(!_0x5422cd)return;dom[_0x4dcd3b(0x15b)][_0x4dcd3b(0x121)]=!![],dom[_0x4dcd3b(0x15b)]['textContent']=_0x4dcd3b(0x163),dom['adminErrorMsg']['classList']['add'](_0x4dcd3b(0x143));try{const _0x1d72c4=await fetch(API_ROOT+_0x4dcd3b(0x112),{'method':'POST','headers':{'Content-Type':_0x4dcd3b(0x141)},'body':JSON[_0x4dcd3b(0x11d)]({'password':_0x5422cd})}),_0x4ead95=await _0x1d72c4[_0x4dcd3b(0x15a)]();if(_0x4ead95['success']){const _0x37def6={'valid':!![],'role':'admin','adminPassword':_0x5422cd,'token':_0x4ead95[_0x4dcd3b(0x139)]};localStorage[_0x4dcd3b(0x11a)](_0x4dcd3b(0x110),JSON[_0x4dcd3b(0x11d)](_0x37def6)),location[_0x4dcd3b(0x134)]();}else dom[_0x4dcd3b(0x14a)][_0x4dcd3b(0x133)]=_0x4ead95['error']||_0x4dcd3b(0x14c),dom[_0x4dcd3b(0x14a)][_0x4dcd3b(0x168)][_0x4dcd3b(0x158)](_0x4dcd3b(0x143)),dom[_0x4dcd3b(0x15b)][_0x4dcd3b(0x121)]=![],dom[_0x4dcd3b(0x15b)][_0x4dcd3b(0x133)]=_0x4dcd3b(0x131);}catch(_0x16bb83){console[_0x4dcd3b(0x11c)](_0x4dcd3b(0x117),_0x16bb83),dom[_0x4dcd3b(0x14a)][_0x4dcd3b(0x133)]=_0x4dcd3b(0x15e),dom['adminErrorMsg'][_0x4dcd3b(0x168)][_0x4dcd3b(0x158)]('hidden'),dom[_0x4dcd3b(0x15b)][_0x4dcd3b(0x121)]=![],dom[_0x4dcd3b(0x15b)][_0x4dcd3b(0x133)]='Login';}}export async function proceedWithLogin(){const _0x4fc19e=a0_0x3ccd60,_0x2cc651=dom[_0x4fc19e(0x166)][_0x4fc19e(0x109)][_0x4fc19e(0x11b)]();if(!_0x2cc651)return;dom['unlockBtn'][_0x4fc19e(0x121)]=!![],dom['unlockBtn'][_0x4fc19e(0x133)]=STRINGS['auth'][_0x4fc19e(0x12d)],await verifyCode(_0x2cc651),!localStorage[_0x4fc19e(0x13e)](_0x4fc19e(0x110))&&(dom['unlockBtn'][_0x4fc19e(0x121)]=![],dom[_0x4fc19e(0x154)][_0x4fc19e(0x133)]=STRINGS[_0x4fc19e(0x13f)][_0x4fc19e(0x13a)]);}export async function verifyCode(_0x57f794){const _0x23f429=a0_0x3ccd60;dom[_0x23f429(0x144)][_0x23f429(0x168)]['add'](_0x23f429(0x143));try{const _0x4c34f1=await fetch(API_ROOT+_0x23f429(0x173),{'method':_0x23f429(0x14e),'headers':{'Content-Type':'application/json'},'body':JSON[_0x23f429(0x11d)]({'passkey':_0x57f794,'deviceId':state[_0x23f429(0x135)]})}),_0x5f4600=await _0x4c34f1['json']();if(_0x5f4600[_0x23f429(0x118)]){const _0x10beb5={'valid':!![],'role':_0x5f4600[_0x23f429(0x15d)]||_0x23f429(0x11f),'token':_0x5f4600[_0x23f429(0x139)]};localStorage[_0x23f429(0x11a)](_0x23f429(0x110),JSON['stringify'](_0x10beb5)),dom[_0x23f429(0x169)][_0x23f429(0x12f)][_0x23f429(0x159)]=0x0,dom[_0x23f429(0x153)][_0x23f429(0x12f)][_0x23f429(0x159)]=0x0,setTimeout(()=>{location['reload']();},0x1f4);}else dom[_0x23f429(0x144)][_0x23f429(0x133)]=_0x5f4600[_0x23f429(0x11c)]||STRINGS[_0x23f429(0x13f)][_0x23f429(0x128)],dom[_0x23f429(0x144)][_0x23f429(0x168)]['remove'](_0x23f429(0x143));}catch(_0x21a99a){console['error'](_0x23f429(0x13d),_0x21a99a),dom[_0x23f429(0x144)]['textContent']=STRINGS[_0x23f429(0x13f)][_0x23f429(0x119)],dom[_0x23f429(0x144)][_0x23f429(0x168)][_0x23f429(0x158)]('hidden');}}export function setupAdminTools(){const _0x513991=a0_0x3ccd60;dom[_0x513991(0x164)][_0x513991(0x168)][_0x513991(0x178)](_0x513991(0x143)),dom[_0x513991(0x120)]['classList'][_0x513991(0x158)](_0x513991(0x143)),dom[_0x513991(0x142)][_0x513991(0x133)]=STRINGS['auth']['adminDate'];if(dom[_0x513991(0x14f)])dom[_0x513991(0x14f)][_0x513991(0x168)][_0x513991(0x178)](_0x513991(0x143));if(dom[_0x513991(0x10a)])dom[_0x513991(0x10a)]['classList']['remove'](_0x513991(0x143));let _0x385dc7='';dom[_0x513991(0x124)][_0x513991(0x171)]=async()=>{const _0x5d634e=_0x513991,_0x19b0e6=JSON[_0x5d634e(0x177)](localStorage[_0x5d634e(0x13e)](_0x5d634e(0x110))),_0x57929a=_0x19b0e6?.['adminPassword']||'';dom[_0x5d634e(0x124)][_0x5d634e(0x121)]=!![],dom[_0x5d634e(0x124)][_0x5d634e(0x133)]=_0x5d634e(0x123),dom['adminStatusMsg'][_0x5d634e(0x168)][_0x5d634e(0x178)](_0x5d634e(0x143));try{const _0x54bfda=await fetch(API_ROOT+_0x5d634e(0x112),{'method':_0x5d634e(0x14e),'headers':{'Content-Type':_0x5d634e(0x141)},'body':JSON['stringify']({'password':_0x57929a})}),_0x4cdc2e=await _0x54bfda['json']();_0x4cdc2e[_0x5d634e(0x118)]&&(_0x385dc7=_0x4cdc2e[_0x5d634e(0x132)],dom[_0x5d634e(0x175)][_0x5d634e(0x133)]=_0x4cdc2e['code'],dom[_0x5d634e(0x170)][_0x5d634e(0x133)]=STRINGS['auth'][_0x5d634e(0x137)],dom[_0x5d634e(0x170)][_0x5d634e(0x168)][_0x5d634e(0x158)](_0x5d634e(0x143)),dom[_0x5d634e(0x10c)][_0x5d634e(0x168)][_0x5d634e(0x158)](_0x5d634e(0x143)));}catch(_0x91793b){}finally{dom[_0x5d634e(0x124)][_0x5d634e(0x121)]=![],dom[_0x5d634e(0x124)][_0x5d634e(0x133)]=STRINGS[_0x5d634e(0x13f)][_0x5d634e(0x124)];}},dom['adminShareBtn']['onclick']=()=>{const _0x5b2fd8=_0x513991;if(!_0x385dc7)return;const _0x44f07e=''+window['location'][_0x5b2fd8(0x16c)]+window[_0x5b2fd8(0x12c)][_0x5b2fd8(0x114)]+_0x5b2fd8(0x157)+_0x385dc7,_0x5f114c=encodeURIComponent(STRINGS['auth']['emailSubject']),_0x1c658b=encodeURIComponent(STRINGS[_0x5b2fd8(0x13f)]['emailBody']['replace']('[CODE]',_0x385dc7)[_0x5b2fd8(0x11e)]('[LINK]',_0x44f07e));window['open'](_0x5b2fd8(0x10f)+_0x5f114c+_0x5b2fd8(0x126)+_0x1c658b,_0x5b2fd8(0x16b));},dom[_0x513991(0x15f)][_0x513991(0x171)]=()=>{const _0x4c0e02=_0x513991;localStorage[_0x4c0e02(0x13b)](_0x4c0e02(0x110)),window['location'][_0x4c0e02(0x134)]();},dom[_0x513991(0x145)]['onclick']=()=>{const _0x133e96=_0x513991;if(dom['landingPage'])dom['landingPage']['remove']();if(dom['gatekeeper'])dom[_0x133e96(0x169)][_0x133e96(0x158)]();dom[_0x133e96(0x125)][_0x133e96(0x168)][_0x133e96(0x178)](_0x133e96(0x143)),dom[_0x133e96(0x116)]['classList'][_0x133e96(0x158)](_0x133e96(0x143)),location[_0x133e96(0x134)]();};}